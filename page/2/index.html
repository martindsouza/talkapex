<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>TalkApex</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="TalkApex">
<meta property="og:url" content="http://www.talkapex.com/page/2/index.html">
<meta property="og:site_name" content="TalkApex">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="TalkApex">
<meta name="twitter:creator" content="@martindsouza">
  
    <link rel="alternate" href="/atom.xml" title="TalkApex" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <!-- <div id="banner"></div> -->
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <img src="/images/header-banner.png" alt>
      <!-- <h1 id="logo-wrap">
        <a href="/" id="logo">TalkApex</a>
      </h1> -->
      <!-- 
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Martin Giffy D&#39;Souza on Oracle APEX</a>
        </h2>
       -->
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://www.talkapex.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-one-thing-you-need-to-do-before-calling-apex-web-service-make-rest-request" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/one-thing-you-need-to-do-before-calling-apex-web-service-make-rest-request/" class="article-date">
  <time datetime="2018-05-16T04:36:15.000Z" itemprop="datePublished">2018-05-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/one-thing-you-need-to-do-before-calling-apex-web-service-make-rest-request/">One Thing You Need To Do Before Calling apex_web_service.make_rest_request</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Can you spot the bug in the following code? (<em>Hint: it compiles and no run-time errors</em>)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ...</span></span><br><span class="line">l_json := apex_web_service.make_rest_request(</span><br><span class="line">  p_url =&gt; 'http://someurl.com/data',</span><br><span class="line">  p_http_method =&gt; 'GET'</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- ...</span></span><br></pre></td></tr></table></figure>
<p>It’s not so obvious until I expose the code that preceded it. So let’s try this again (with more information). Can you spot the bug in the following code?</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ...</span></span><br><span class="line">apex_web_service.g_request_headers(1).name := 'Authorization';</span><br><span class="line">apex_web_service.g_request_headers(1).value := 'Bearer token123';</span><br><span class="line">l_json := apex_web_service.make_rest_request(</span><br><span class="line">  p_url =&gt; 'http://a-differnt-url.com/data',</span><br><span class="line">  p_http_method =&gt; 'GET'</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">l_json := apex_web_service.make_rest_request(</span><br><span class="line">  p_url =&gt; 'http://someurl.com/data',</span><br><span class="line">  p_http_method =&gt; 'GET'</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- ...</span></span><br></pre></td></tr></table></figure>
<p>The issue with the second call to <code>apex_web_service.make_rest_request</code> is that it will use the request headers that were set for the first call (to <code>a-differnt-url.com</code>). If the second web service (<code>someurl.com</code>) doesn’t want/need/expect that header it can cause some unintended issues and may result in an invalid RESTful call.</p>
<p>To get around this simply clear the request headers each time before setting them / calling <code>apex_web_service.make_rest_request</code>. You can do this by calling <code>apex_web_service.g_request_headers.delete();</code> The following code is the correct way to run the previous example:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ...</span></span><br><span class="line">apex_web_service.g_request_headers.delete();</span><br><span class="line">apex_web_service.g_request_headers(1).name := 'Authorization';</span><br><span class="line">apex_web_service.g_request_headers(1).value := 'Bearer token123';</span><br><span class="line">l_json := apex_web_service.make_rest_request(</span><br><span class="line">  p_url =&gt; 'http://a-differnt-url.com/data',</span><br><span class="line">  p_http_method =&gt; 'GET'</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">apex_web_service.g_request_headers.delete();</span><br><span class="line">l_json := apex_web_service.make_rest_request(</span><br><span class="line">  p_url =&gt; 'http://someurl.com/data',</span><br><span class="line">  p_http_method =&gt; 'GET'</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- ...</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.talkapex.com/2018/05/one-thing-you-need-to-do-before-calling-apex-web-service-make-rest-request/" data-id="cjso50c0s00fjedrafsta4h72" class="article-share-link">Share</a>
      
        <a href="http://www.talkapex.com/2018/05/one-thing-you-need-to-do-before-calling-apex-web-service-make-rest-request/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/apex/">apex</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/plsql/">plsql</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-apex-page-item-source-vs-default" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/04/apex-page-item-source-vs-default/" class="article-date">
  <time datetime="2018-04-05T04:50:45.000Z" itemprop="datePublished">2018-04-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/apex-page-item-source-vs-default/">APEX Page Item Source vs Default</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Someone recently asked me about the difference between an APEX page item’s <code>Source</code>  and <code>Default</code> attributes. I’ve always been confused about these options so I decided to further investigate them. This post will cover the differences between Source and Default along with some additional info.</p>
<img src="/2018/04/apex-page-item-source-vs-default/source-default.png">
<h2 id="Order-of-Operations"><a href="#Order-of-Operations" class="headerlink" title="Order of Operations"></a>Order of Operations</h2><p>Page items can be set in different ways and there is an order of operations to which “setting” takes precedence:</p>
<ol>
<li><strong>Session State</strong>: What ever is in session state will always trump the page item’s Source or Default settings_*_</li>
<li><strong>Source</strong>: Source comes next. For most people this is <code>null</code> or <code>Database Column</code> (if using <code>Automatic Row Fetch</code>)</li>
<li><strong>Default</strong>: If the page item is still null then Default will be used. This attribute doesn’t have as many options as Source (just <code>Static Value</code>, <code>PL/SQL Expression</code>, and <code>PL/SQL Function Body</code>)</li>
</ol>
<p><em>* The Source attribute has an option to ignore the current session state value.</em></p>
<h2 id="Session-State-vs-On-Screen"><a href="#Session-State-vs-On-Screen" class="headerlink" title="Session State vs On Screen"></a>Session State vs On Screen</h2><p>Neither Source or Default saves the value to session state_*_. Instead it is what is shown on screen. If Source or Default is used the value will only be saved to session state once the page is submitted.</p>
<p><em>* Read below as the value is temporarily used in session state for the remaining duration of the page load.</em></p>
<h2 id="Additional-Info"><a href="#Additional-Info" class="headerlink" title="Additional Info"></a>Additional Info</h2><h3 id="Is-Default-always-Necessary"><a href="#Is-Default-always-Necessary" class="headerlink" title="Is Default always Necessary?"></a>Is Default always Necessary?</h3><p>I think a lot of the confusion with Source and Default is that in some cases Default is redundant and unnecessary. I think Default is only required when the Source is set to <code>Database Column</code>, <code>Item</code>, or <code>Preference</code>. For the other options (see below) you can wrap the returned value with a <code>nvl</code>.</p>
<img src="/2018/04/apex-page-item-source-vs-default/source-types.png">
<h3 id="Source-Used-Attribute"><a href="#Source-Used-Attribute" class="headerlink" title="Source Used Attribute"></a>Source <code>Used</code> Attribute</h3><p>Source has additional attribute that Default does not: <code>Used</code></p>
<img src="/2018/04/apex-page-item-source-vs-default/source-used.png">
<p>If the <code>used</code> option is set to <code>Always, replacing any existing value in session state</code> this means that after the page has loaded the value in Session State may have a value that is different than the value that is shown on the screen. The following image shows the result of this situation (i.e. different session state vs on screen value).</p>
<img src="/2018/04/apex-page-item-source-vs-default/session-source-diff.png">
<h3 id="Temporary-Change-of-Session-State"><a href="#Temporary-Change-of-Session-State" class="headerlink" title="Temporary Change of Session State"></a>Temporary Change of Session State</h3><p>Suppose that a <code>Before Header</code> computation exists and sets <code>P1_DEMO</code> to a static value: <code>From Computation</code>. This means that during page load, right after the computation is run, the session state value for <code>P1_DEMO</code> is <code>From Computation</code>. </p>
<p><code>P1_DEMO</code> Source is set to <code>From Source</code> and <code>Always, replacing any existing value in session state</code> is used. After <code>P1_DEMO</code> is “loaded” during the page load computation, the session state of <code>P1_DEMO</code> is <code>From Source</code> for the duration of the page load. After the page is loaded the session state value is <code>From Computation</code>. The following image highlights this. For both the <code>Before</code> and <code>After</code> display only items the Source was set to <code>&amp;P1_DEMO.</code></p>
<img src="/2018/04/apex-page-item-source-vs-default/session-state-temp-change.png">
<p>This can cause some weird behaviors on a page that has AJAX calls. The value in session state changes during the page load process. After the page is loaded it may flip flop and the AJAX call could use the “old” session state value (see screen shot above).</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.talkapex.com/2018/04/apex-page-item-source-vs-default/" data-id="cjso50c0p00feedracggvpg4m" class="article-share-link">Share</a>
      
        <a href="http://www.talkapex.com/2018/04/apex-page-item-source-vs-default/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/apex/">apex</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-docker-as-a-micro-service" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/04/docker-as-a-micro-service/" class="article-date">
  <time datetime="2018-04-05T04:41:37.000Z" itemprop="datePublished">2018-04-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/docker-as-a-micro-service/">Docker as a Micro Service</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>One thing I really dislike when trying to install new command line (CLI) software is the uninstall process isn’t always very clear. Things can get worse if the software has additional dependencies (Java for example) especially when you need to have two versions of the same tool for different apps.</p>
<p>Docker solves this problem by keeping everything you need for a specific task in one container. The added bonus is that you’ll probably be able to find a Docker container for just about anything you want and it’s OS independent on <a href="https://hub.docker.com/" target="_blank" rel="noopener">Docker Hub</a>.</p>
<p>At <a href="https://www.insum.ca/hackathon-opportunity-work-with-new-technology/" target="_blank" rel="noopener">Insum’s 2018 Hackathon</a> we developed skills for <a href="https://alexa.amazon.com" target="_blank" rel="noopener">Amazon Alexa</a>. To help the teams I published a <a href="https://hub.docker.com/r/martindsouza/amazon-ask-cli/" target="_blank" rel="noopener">Docker image</a> that has both the <a href="https://aws.amazon.com/cli/" target="_blank" rel="noopener">AWS CLI</a> and <a href="https://developer.amazon.com/docs/smapi/quick-start-alexa-skills-kit-command-line-interface.html" target="_blank" rel="noopener">Alexa Skills Kit (ASK) CLI</a>. </p>
<p>Most of the demos I’ve seen for containers that are used for CLI tools looked like this:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run -it \</span><br><span class="line">  ...</span><br><span class="line">  doccker_prefs</span><br><span class="line">  my_tool.sh -some -parameters</span><br></pre></td></tr></table></figure>
<p>Though these containers are helpful it’s not really useful for end users (i.e. developers) since the command can be tough to remember and the containers may exist after running the tool (i.e. you may need to manually delete them.</p>
<p>When building the <a href="https://hub.docker.com/r/martindsouza/amazon-ask-cli/" target="_blank" rel="noopener">Amazon ASK CLI container</a> I wanted to avoid these issues to make it as easy as possible for developers to use. I did the following tricks:</p>
<h2 id="alias-the-docker-run-command"><a href="#alias-the-docker-run-command" class="headerlink" title="alias the docker run command"></a><code>alias</code> the <code>docker run</code> command</h2><p>Instead of having to remember the long <code>docker run</code> command with all the parameters I used an <code>alias</code> command to bundle it all together. Mine looked like this:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> alexa=<span class="string">"docker run -it --rm \</span></span><br><span class="line"><span class="string">  -v ~/alexa-demo/ask-config:/home/node/.ask \</span></span><br><span class="line"><span class="string">  -v ~/alexa-demo/aws-config:/home/node/.aws \</span></span><br><span class="line"><span class="string">  -v ~/alexa-demo/app:/home/node/app \</span></span><br><span class="line"><span class="string">  martindsouza/amazon-ask-cli:latest</span></span><br></pre></td></tr></table></figure>
<p>A few key things to note from the above snippet:</p>
<ul>
<li><code>alias</code>: This means that anytime I type in <code>alexa</code> in bash it will run everything in the quotes.<ul>
<li><em>Windows users: <code>alias</code> doesn’t exist in DOS or PowerShell. I’m not aware of any alternatives. If you know of any easy ones please leave a comment and I’ll update this post</em></li>
</ul>
</li>
<li><code>--rm</code> option: Deletes (self destruct) the container after the command is run. This means is that when I run <code>alexa ask init</code> (where <code>ask init</code> is the CLI tool) it’ll <code>run</code> the container, execute <code>ask</code> (with parameter <code>init</code>), then remove the container once <code>ask</code> is done.</li>
</ul>
<p>Using the <code>alias</code> and <code>--rm</code> techniques you can easily have all the CLI tools you want without cluttering up your base machine. Of course there may be some minor performance impacts by Dockerizing them. Personally I didn’t notice any slowdowns and will start using this technique for all my future CLI tools.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.talkapex.com/2018/04/docker-as-a-micro-service/" data-id="cjso50c0r00fgedra4cmbophb" class="article-share-link">Share</a>
      
        <a href="http://www.talkapex.com/2018/04/docker-as-a-micro-service/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-docker-image-for-ords-standalone" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/04/docker-image-for-ords-standalone/" class="article-date">
  <time datetime="2018-04-02T02:00:42.000Z" itemprop="datePublished">2018-04-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/04/docker-image-for-ords-standalone/">Docker Image for ORDS Standalone</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>A while ago I released a Docker image for <a href="https://github.com/martindsouza/docker-ords/releases/tag/tomcat-0.1.0" target="_blank" rel="noopener">ORDS using Tocmat</a>. I’ve tagged that script and have since rebuilt this image to use ORDS standalone as well as updating it to <code>17.4.1</code>.</p>
<p>If you’re interested in using it, the entire project along with documentation is available here: <a href="https://github.com/martindsouza/docker-ords" target="_blank" rel="noopener">github.com/martindsouza/docker-ords</a>. </p>
<p>A few things to note about this Docker image:</p>
<ul>
<li>The configuration folder points to a mountable volume. If you store your configuration on a shared folder or version control system you can have ORDS point at it. If you need to have multiple versions of ORDS running this can be helpful since they can all point to the same configuration.<ul>
<li>If you don’t have a shared configuration that’s fine. The container will install and configure ORDS if one isn’t found.</li>
</ul>
</li>
<li>I could not post this image on Docker Hub as Oracle requires that you <a href="http://www.oracle.com/technetwork/developer-tools/rest-data-services/downloads/index.html" target="_blank" rel="noopener">download ORDS</a> yourself and accept their terms and conditions. This means that you need to build your own Docker image (this adds a few minimal steps to the overall process).</li>
<li>The image currently does not have SSL support and can be added it in if there’s interest. Please vote or leave a comment on the <a href="https://github.com/martindsouza/docker-ords/issues/7" target="_blank" rel="noopener">“Add Support for SSL”</a> issue if you’d like it.</li>
</ul>
<p>If you have any other feedback or suggestions please create an <a href="https://github.com/martindsouza/docker-ords/issues" target="_blank" rel="noopener">issue</a> on the project page.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.talkapex.com/2018/04/docker-image-for-ords-standalone/" data-id="cjso50c0o00fcedramjjaynn4" class="article-share-link">Share</a>
      
        <a href="http://www.talkapex.com/2018/04/docker-image-for-ords-standalone/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ords/">ords</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-how-to-save-page-data-but-show-errors-in-apex" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/03/how-to-save-page-data-but-show-errors-in-apex/" class="article-date">
  <time datetime="2018-03-29T14:15:48.000Z" itemprop="datePublished">2018-03-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/03/how-to-save-page-data-but-show-errors-in-apex/">How to Save Page Data but Show Errors in APEX</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>In most cases error messages are shown on an APEX page when the user submits a form and a validation fails. Sometimes (not often) you may need to manually control the validations rather than using the declarative validations section. To do this you can use the <a href="https://docs.oracle.com/database/apex-5.1/AEAPI/APEX_ERROR.htm#AEAPI2209" target="_blank" rel="noopener"><code>apex_error</code></a> API. The following is an example of how to call the API.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apex_error.add_error(</span><br><span class="line">  p_message =&gt; 'Custom error from PL/SQL',</span><br><span class="line">  p_display_location =&gt; apex_error.c_inline_in_notification);</span><br></pre></td></tr></table></figure>
<p>This will generate the following on the page:</p>
<img src="/2018/03/how-to-save-page-data-but-show-errors-in-apex/custom-error.png">
<p><code>apex_error.add_error</code> triggers a rollback and in most cases this is a good thing. In some very specific cases you may not want a rollback to occur. The rest of this article covers how to generate errors without a rollback occurring.</p>
<h2 id="Edge-Case"><a href="#Edge-Case" class="headerlink" title="Edge Case"></a>Edge Case</h2><p>I recently had a rare edge case for a page submit and errors. The page was used to edit batch staging data. The requirements were:</p>
<ul>
<li>User submits page</li>
<li>All the data is saved (in a staging table)<ul>
<li>_Since this is staging area, the data must be saved and committed each time regardless of errors _</li>
</ul>
</li>
<li>Do validations against staged data<ul>
<li>If errors were found, the page would show them (remember the data still needs to be saved)</li>
<li>If no errors were found, the staged data would be posted and then branch to another page.</li>
</ul>
</li>
</ul>
<h2 id="The-Solution"><a href="#The-Solution" class="headerlink" title="The Solution"></a>The Solution</h2><p>Given that <code>apex_error.add_error</code> performs a rollback the simple solution is to save the staged data, perform an explicit <code>commit</code>, and then do custom validations. Unfortunately this was not possible due to additional requirements that I left out of this article.</p>
<p><em>The following relies on the fact that you know about the <code>apex.message</code> API. If you do not please read <a href="/2018/03/custom-apex-notification-messages/" title="this article">this article</a>.</em></p>
<p>This is an overview of the final solution:</p>
<ul>
<li>On Submit PL/SQL page process that:<ul>
<li>Saved all the page’s data</li>
<li>Called a custom validation function that returned a JSON object. If no errors were found this function would return <code>null</code>. The results of this function were stored in the page item <code>P1_ERR_JSON</code>.</li>
</ul>
</li>
<li>Created an <code>onPageLoad</code> Dynamic Action to display errors using the <code>apex.message</code> API</li>
</ul>
<p>The following pseudo code summarizes the above description:</p>
<h3 id="Page-Process"><a href="#Page-Process" class="headerlink" title="Page Process"></a>Page Process</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ...</span></span><br><span class="line"><span class="comment">-- Save staging data</span></span><br><span class="line"><span class="comment">-- ...</span></span><br><span class="line"><span class="comment">-- Validations:</span></span><br><span class="line">l_err_json := null;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sum</span>(salary)</span><br><span class="line"><span class="keyword">into</span> l_salary_total</span><br><span class="line"><span class="keyword">from</span> my_stage_table;</span><br><span class="line"></span><br><span class="line">if l_salary_total &gt; 1000 then</span><br><span class="line">  <span class="comment">-- Produce JSON error like:</span></span><br><span class="line">  <span class="comment">-- &#123;</span></span><br><span class="line">  <span class="comment">--   "errMsg": "Total salary must be less than $1000"</span></span><br><span class="line">  <span class="comment">-- &#125;</span></span><br><span class="line">  apex_json.initialize_clob_output;</span><br><span class="line">  apex_json.open_object;</span><br><span class="line">  apex_json.write('errMsg', 'Total salary must be less than $1000');</span><br><span class="line">  apex_json.close_object;</span><br><span class="line"></span><br><span class="line">  l_err_json := apex_json.get_clob_output;</span><br><span class="line">  apex_json.free_output;</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"></span><br><span class="line">apex_util.set_session_state('P1_ERR_JSON', l_err_json, false);</span><br></pre></td></tr></table></figure>
<h3 id="onPageLoad-Dynamic-Action"><a href="#onPageLoad-Dynamic-Action" class="headerlink" title="onPageLoad Dynamic Action"></a><code>onPageLoad</code> Dynamic Action</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">err = apex.item(<span class="string">'P1_ERR_JSON'</span>).getValue();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (err.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">  err = <span class="built_in">JSON</span>.parse(err);</span><br><span class="line"></span><br><span class="line">  apex.message.clearErrors();</span><br><span class="line">  apex.message.showErrors([</span><br><span class="line">    &#123;</span><br><span class="line">      type: apex.message.TYPE.ERROR,</span><br><span class="line">      location: [<span class="string">"page"</span>],</span><br><span class="line">      message: err.errMsg,</span><br><span class="line">      unsafe: <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]);</span><br><span class="line">&#125;<span class="comment">// end if</span></span><br></pre></td></tr></table></figure>
<p>When an error occurred, the page looked like:</p>
<img src="/2018/03/how-to-save-page-data-but-show-errors-in-apex/total-error.png">
<h2 id="Wrapping-Up"><a href="#Wrapping-Up" class="headerlink" title="Wrapping Up"></a>Wrapping Up</h2><p>This solution is a summary of the final code. You can easily expand it to handle multiple error messages, associate with page items, etc.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.talkapex.com/2018/03/how-to-save-page-data-but-show-errors-in-apex/" data-id="cjso50c0m00f9edraqo2i56gy" class="article-share-link">Share</a>
      
        <a href="http://www.talkapex.com/2018/03/how-to-save-page-data-but-show-errors-in-apex/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/apex-5-1/">apex-5.1</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-custom-apex-notification-messages" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/03/custom-apex-notification-messages/" class="article-date">
  <time datetime="2018-03-29T14:00:19.000Z" itemprop="datePublished">2018-03-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/03/custom-apex-notification-messages/">Custom APEX Notification Messages</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Ever wonder how APEX generates error messages (shown below)? Want to create your own? Starting in APEX 5.1 you can create your own error and success messages using the <a href="https://docs.oracle.com/database/apex-5.1/AEAPI/apex-message-namespace.htm#AEAPI-GUID-D15040D1-6B1A-4267-8DF7-B645ED1FDA46" target="_blank" rel="noopener"><code>apex.message</code></a> library.</p>
<img src="/2018/03/custom-apex-notification-messages/apex-error-message.png">
<p>The following demos show how to create custom error and success messages in JavaScript.</p>
<h2 id="Error-Messages"><a href="#Error-Messages" class="headerlink" title="Error Messages"></a>Error Messages</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">apex.message.clearErrors();</span><br><span class="line"></span><br><span class="line">apex.message.showErrors([</span><br><span class="line">  &#123;</span><br><span class="line">    type: apex.message.TYPE.ERROR,</span><br><span class="line">    location: [<span class="string">"page"</span>, <span class="string">"inline"</span>],</span><br><span class="line">    pageItem: <span class="string">"P1_DEMO"</span>,</span><br><span class="line">    message: <span class="string">"This field is required"</span>,</span><br><span class="line">    unsafe: <span class="literal">false</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    type: apex.message.TYPE.ERROR,</span><br><span class="line">    location: [<span class="string">"page"</span>],</span><br><span class="line">    message: <span class="string">"Page level error"</span>,</span><br><span class="line">    unsafe: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>
<p><br></p>
<img src="/2018/03/custom-apex-notification-messages/apex-custom-error-message.png">
<h2 id="Success-Message"><a href="#Success-Message" class="headerlink" title="Success Message"></a>Success Message</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apex.message.clearErrors();</span><br><span class="line"></span><br><span class="line">apex.message.showPageSuccess( <span class="string">"It works!"</span> );</span><br></pre></td></tr></table></figure>
<p><br></p>
<img src="/2018/03/custom-apex-notification-messages/apex-custom-success-message.png">
<h2 id="Wrap-up"><a href="#Wrap-up" class="headerlink" title="Wrap up"></a>Wrap up</h2><p>For more examples and full documentation read the <a href="https://docs.oracle.com/database/apex-5.1/AEAPI/apex-message-namespace.htm#AEAPI-GUID-D15040D1-6B1A-4267-8DF7-B645ED1FDA46" target="_blank" rel="noopener"><code>apex.message</code></a> documentation.</p>
<p>The <a href="/2018/03/how-to-save-page-data-but-show-errors-in-apex/" title="next post">next post</a> covers how to leverage the <code>apex_message</code> API to simulate an error in APEX without an error happening (it will also cover why you’d want to do this).</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.talkapex.com/2018/03/custom-apex-notification-messages/" data-id="cjso50c0v00fnedraiof3ib5r" class="article-share-link">Share</a>
      
        <a href="http://www.talkapex.com/2018/03/custom-apex-notification-messages/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/apex-5-1/">apex-5.1</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-what-a-bag-of-frozen-blueberries-can-teach-you-about-software-development" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/03/what-a-bag-of-frozen-blueberries-can-teach-you-about-software-development/" class="article-date">
  <time datetime="2018-03-28T03:30:00.000Z" itemprop="datePublished">2018-03-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/03/what-a-bag-of-frozen-blueberries-can-teach-you-about-software-development/">What a Bag of Frozen Blueberries Can Teach you about Software Design</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I recently opened my freezer found this bag of frozen blueberries:</p>
<img src="/2018/03/what-a-bag-of-frozen-blueberries-can-teach-you-about-software-development/IMG_9826.jpg">
<p>I was a bit surprised to say the least, especially since the bag has a “E-Z Tab” along with a “PULL TO OPEN” (all caps) instruction label.</p>
<img src="/2018/03/what-a-bag-of-frozen-blueberries-can-teach-you-about-software-development/IMG_9827.jpg">
<p>What does this have to do with software development? Everything. The rest of this post compares the bag of blueberries with software development.</p>
<h2 id="What-happened"><a href="#What-happened" class="headerlink" title="What happened?"></a>What happened?</h2><p>The most obvious thing to ask is why is their such a huge tear in the bag? Clearly someone didn’t take a few seconds to look at the bag and see that it already had built-in resealable functionality. Instead they determined it faster to tear open the bag (which it wasn’t) and then spent the additional time to find an elastic and in an unsuccessful attempt (first image) seal it back up.</p>
<h2 id="Bad-Design-Encourages-Bad-Design"><a href="#Bad-Design-Encourages-Bad-Design" class="headerlink" title="Bad Design Encourages Bad Design"></a>Bad Design Encourages Bad Design</h2><p>I’ve encountered the “torn blueberry bag” in many systems I’ve worked on over the years (some which have been my doing). I noticed that they all share the same pattern. A bad/quick design was put in place and then everything was piled on top of it just making the problem worse. When I run into these issues I try to analyze them and see if/how we can improve them. Here’s my detailed analysis on the bag of blueberries:</p>
<h3 id="1-The-Tear"><a href="#1-The-Tear" class="headerlink" title="1- The Tear"></a>1- The Tear</h3><p>This was a horrible decision for various reasons. First the opening now is too big which leads to more problems such as spillage, and does not make it easy to re-seal (more of this later). The “man-made” hole is not straight. Taking a pair of scissors would have made it more uniform, thus easier to maintain in the long run.</p>
<h3 id="2-The-Elastic"><a href="#2-The-Elastic" class="headerlink" title="2- The Elastic"></a>2- The Elastic</h3><p>Now that the bag has been (poorly) torn the solution to re-seal it was to use an elastic that clearly wasn’t properly put on. This lead to a few stray blueberries scattered in the freezer when I took the bag out. </p>
<p>The elastic is a key point in this solution. When shortcuts occur in software people tend to focus on the elastic and come to the following conclusions:</p>
<ul>
<li>The elastic wasn’t put on properly</li>
<li>Since the elastic wasn’t put on properly, the freezer had a bunch of loose blueberries in it</li>
<li>I spent time cleaning out the freezer to get the loose blueberries</li>
</ul>
<p>It’s easy to blame the how the elastic was put on and the side effects it caused but it’s the wrong approach. Instead of focusing on issues right in front of you, step back and ask yourself if this was the root cause of the problem or a side affect of a bad design decision.</p>
<h3 id="3-The-Future"><a href="#3-The-Future" class="headerlink" title="3- The Future"></a>3- The Future</h3><p>For the rest of the life of the bag I have to find a way to properly reseal it. Sometimes the hack elastic job will work, sometimes it won’t. I’ll probably still be dealing with stray blueberries in my freezer, thus adding to the mess. Thankfully I like blueberries and will go through the bag quickly. I won’t have to deal with the torn bag for too long but software usually lasts a very long time.</p>
<h2 id="Recap"><a href="#Recap" class="headerlink" title="Recap"></a>Recap</h2><p>A post-implementation analysis would have brought up the following questions:</p>
<ul>
<li>Did tearing the bag open rather than spending a minute to see if there was a better way save time? No.</li>
<li>Did tearing it open make the situation better? No.</li>
<li>What gain was made quickly tearing the bag open? None.</li>
<li>What additional side affects were caused because of it? Wasted time, spilled blueberries, and this blog post ;-).</li>
</ul>
<p>The perceived gain is that someone accessed the blueberries quicker for their needs. The reality is they just made things harder and created a compounding problem.</p>
<h2 id="Lessons-Learned"><a href="#Lessons-Learned" class="headerlink" title="Lessons Learned"></a>Lessons Learned</h2><ul>
<li>When working on software projects always remember that taking a some extra time to think things through and review options can save a lot of time</li>
<li>Rushed decisions usually lead to bad designs</li>
<li>When encountering these issues, focus on the root cause rather than the symptoms</li>
<li>Bad designs lead to more bad designs</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.talkapex.com/2018/03/what-a-bag-of-frozen-blueberries-can-teach-you-about-software-development/" data-id="cjso50c0k00f7edrahy5oojxt" class="article-share-link">Share</a>
      
        <a href="http://www.talkapex.com/2018/03/what-a-bag-of-frozen-blueberries-can-teach-you-about-software-development/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/design/">design</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-how-to-develop-with-multiple-apex-developer-tabs-in-firefox" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/how-to-develop-with-multiple-apex-developer-tabs-in-firefox/" class="article-date">
  <time datetime="2017-11-20T03:35:42.000Z" itemprop="datePublished">2017-11-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/how-to-develop-with-multiple-apex-developer-tabs-in-firefox/">How to Develop with Multiple APEX Developer Tabs in Firefox</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Eventually all APEX developers need to have multiple versions of the development environment open at the same time. A simple example of this is if you’re working with two pages (Page 1 and Page 2) that are dependant on one another. You constantly have to toggle between them as you can’t have two tabs open for development (one for P1 and one for P2).</p>
<p>Most people either open a different browser or open a new browser tab in Private or Incognito mode. Now <a href="https://www.mozilla.org/" target="_blank" rel="noopener">Firefox</a> allows you to get around this issue by having <a href="https://blog.mozilla.org/firefox/introducing-firefox-multi-account-containers/" target="_blank" rel="noopener">Multi-Account Containers</a>. </p>
<img src="/2017/11/how-to-develop-with-multiple-apex-developer-tabs-in-firefox/firefox-multi-account-containers.png">
<p>Multi-Account Containers segregate your cookies by containers. Aside from APEX development you can also have multiple instances of Gmail or Office 365 opened in different container tabs.</p>
<p>For now you must install the <a href="https://addons.mozilla.org/en-US/firefox/addon/multi-account-containers/?src=userprofile" target="_blank" rel="noopener">Multi-Account Containers Plugin</a> (built by Mozilla) as it’s not included by default. Note I use the plugin on <a href="https://www.mozilla.org/en-US/firefox/developer/" target="_blank" rel="noopener">Firefox Developer Edition</a> with no issues.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.talkapex.com/2017/11/how-to-develop-with-multiple-apex-developer-tabs-in-firefox/" data-id="cjso50c0h00f5edrawoa51g1a" class="article-share-link">Share</a>
      
        <a href="http://www.talkapex.com/2017/11/how-to-develop-with-multiple-apex-developer-tabs-in-firefox/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/apex/">apex</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-how-to-setup-multiple-apex-environments-using-docker-and-oracle-12c" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/how-to-setup-multiple-apex-environments-using-docker-and-oracle-12c/" class="article-date">
  <time datetime="2017-11-19T14:31:49.000Z" itemprop="datePublished">2017-11-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/how-to-setup-multiple-apex-environments-using-docker-and-oracle-12c/">How to Setup Multiple APEX Environments using Docker and Oracle 12c</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I’ve written a few posts on how to Dockerize your Oracle and APEX setup (<a href="/2017/10/how-to-setup-oracle-db-12-2-docker-container/" title="post 1">post 1</a>, <a href="/2017/10/docker-oracle-and-apex/" title="post 2">post 2</a>). I’m constantly refining the process as I learn new things and different Docker images become available.</p>
<p>I was writing a third post on setting up multiple APEX environments using Docker and Oracle 12c. The post was getting long and included many steps. I decided to move the instructions to Github as it solves two problems:</p>
<ul>
<li>I can easily keep it up to date with the latest steps I do to create my Docker containers</li>
<li>Others can contribute to the instructions (and/or include scripts) by making pull requests (PR)</li>
</ul>
<p>To view my latest Docker setup you can view my <a href="https://github.com/martindsouza/docker-oracle-setup" target="_blank" rel="noopener">docker-oracle-setup</a> page on Github. If you have any corrections, suggestions, or enhancements please create issues or submit a PR on the repository.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.talkapex.com/2017/11/how-to-setup-multiple-apex-environments-using-docker-and-oracle-12c/" data-id="cjso50c0g00f3edrayml4ne4t" class="article-share-link">Share</a>
      
        <a href="http://www.talkapex.com/2017/11/how-to-setup-multiple-apex-environments-using-docker-and-oracle-12c/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/apex/">apex</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/oracle-12c/">oracle-12c</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-how-to-convert-dec-to-any-base-in-sql" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/how-to-convert-dec-to-any-base-in-sql/" class="article-date">
  <time datetime="2017-11-07T03:26:15.000Z" itemprop="datePublished">2017-11-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/how-to-convert-dec-to-any-base-in-sql/">How to Convert Dec to Any Base in SQL</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>If you want to convert decimal (base 10) to to hexadecimal (base 16) in SQL you can do so easily with the built in <code>to_char</code> functionality:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">trim</span>(to_char(<span class="number">300</span>, <span class="string">'XXXXX'</span>)) dec2hex</span><br><span class="line"><span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line">DEC2HEX</span><br><span class="line">12C</span><br></pre></td></tr></table></figure>
<p>What if you wanted to convert a decimal number to base 20 or any other base? This question recently came up when I was looking to add a <a href="https://github.com/OraOpenSource/oos-utils/issues/173" target="_blank" rel="noopener">transactional number generator</a> for <a href="https://github.com/OraOpenSource/oos-utils" target="_blank" rel="noopener">OOS Utils</a>. The goal of the ticket is to convert a sequence number into a human readable number (ex: invoice number). It can easily be solved using PL/SQL (solution below) but I wanted to see if I could do it in SQL as it presents an interesting problem.</p>
<h2 id="The-Formula"><a href="#The-Formula" class="headerlink" title="The Formula"></a>The Formula</h2><p>For some, this section will go down memory lane to your college / university years where you had to convert dec to hex by hand. It’s important to understand the formula to convert dec to hex (or any base),</p>
<p>Using the first example, this is how to convert <code>300</code> to <code>12C</code> “by hand”: <em>Note <code>Q</code> = Quotient, <code>R</code> = Remainder</em></p>
<ul>
<li><code>300/16 = Q: 18, R: 12 (hex: C)</code></li>
<li><code>18/16 = Q:1, R: 2 (hex: 2)</code></li>
<li><code>1/16 = Q: 0, R: 1 (hex: 1)</code></li>
</ul>
<p>The steps above produce the hexadecimal number <code>12C</code>. More importantly, each value is dependent on the calculation of the previous line. This isn’t easy to do in SQL.</p>
<h2 id="PL-SQL-Function"><a href="#PL-SQL-Function" class="headerlink" title="PL/SQL Function"></a>PL/SQL Function</h2><p>The following function will convert dec to hex in PL/SQL:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">function</span> dec2hex (</span><br><span class="line">  p_num <span class="keyword">in</span> <span class="built_in">integer</span>)</span><br><span class="line">  <span class="keyword">return</span> varchar2</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line">  l_return varchar2(<span class="number">255</span>);</span><br><span class="line">  l_quotient integer;</span><br><span class="line">  l_remainder integer;</span><br><span class="line">  c_base constant pls_integer := 16;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">  l_quotient := p_num;</span><br><span class="line"></span><br><span class="line">  while l_quotient &gt; 0 loop</span><br><span class="line">    l_remainder := mod(l_quotient, c_base);</span><br><span class="line">    l_quotient := trunc(l_quotient / c_base);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- A=10, B=11, ... F=15</span></span><br><span class="line">    l_return := substr('0123456789ABCDEF', l_remainder+1, 1) || l_return;</span><br><span class="line">  <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"></span><br><span class="line">  return l_return;</span><br><span class="line"><span class="keyword">end</span> dec2hex;</span><br><span class="line">/</span><br></pre></td></tr></table></figure>
<p>As you can see PL/SQL uses the quotient from the previous loop to calculate the current loop’s remainder.</p>
<h2 id="SQL-Solution"><a href="#SQL-Solution" class="headerlink" title="SQL Solution"></a>SQL Solution</h2><p>In SQL, finding the value of the previous row is easy using an analytic function such as <a href="https://docs.oracle.com/database/122/SQLRF/Analytic-Functions.htm#SQLRF06174" target="_blank" rel="noopener"><code>lag</code></a>. If you’ve never used analytic functions before, <a href="https://twitter.com/connor_mc_d" target="_blank" rel="noopener">Connor McDonald</a> has a great <a href="https://www.youtube.com/watch?v=xvZ4SmKtazs" target="_blank" rel="noopener">series on youtube</a> about them.</p>
<p>Using the previous row’s calculated value for the current row is more difficult and can’t be done using analytic functions. This is where the <a href="https://docs.oracle.com/database/122/SQLRF/SELECT.htm#GUID-CFA006CA-6FF1-4972-821E-6996142A51C6__I2171160" target="_blank" rel="noopener">model clause</a> comes in. It’s one of the lesser known features in Oracle SQL but very powerful in the right circumstances.</p>
<p>The query below will do dec to hex (or any other “base X”) conversion. For demo purposes I have left the <code>select ... from my_data</code> portion uncommented to highlight the model clause. To do a full translation uncomment the last few lines.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">var x number;</span><br><span class="line">var base number;</span><br><span class="line"></span><br><span class="line">:x := 300;</span><br><span class="line">:base := 16;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span></span><br><span class="line">  <span class="comment">-- Find how many loops we'll need to convert dec to basex</span></span><br><span class="line">  lvls <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">level</span> lvl</span><br><span class="line">    <span class="keyword">from</span> dual</span><br><span class="line">    <span class="comment">-- The &lt;= logic will return the number of characters required for conversion</span></span><br><span class="line">    <span class="keyword">connect</span> <span class="keyword">by</span> <span class="keyword">level</span> &lt;= <span class="keyword">ceil</span>(<span class="keyword">log</span>(:base, :x)) + <span class="keyword">decode</span>(<span class="keyword">log</span>(:base, :x), <span class="keyword">ceil</span>(<span class="keyword">log</span>(:base, :x)), <span class="number">1</span>,<span class="number">0</span>)</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">-- Alphabet 0..Z</span></span><br><span class="line">  <span class="comment">-- Where 0-9, A=10, B=11 ....</span></span><br><span class="line">  alphabet <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">      <span class="keyword">level</span><span class="number">-1</span> <span class="keyword">num</span>,</span><br><span class="line">      <span class="keyword">case</span></span><br><span class="line">        <span class="keyword">when</span> <span class="keyword">level</span><span class="number">-1</span> &lt; <span class="number">10</span> <span class="keyword">then</span> to_char(<span class="keyword">level</span><span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">chr</span>( <span class="keyword">ascii</span>(<span class="string">'A'</span>)+<span class="keyword">level</span><span class="number">-1</span><span class="number">-10</span>)</span><br><span class="line">      <span class="keyword">end</span> letter</span><br><span class="line">    <span class="keyword">from</span> dual</span><br><span class="line">    <span class="keyword">connect</span> <span class="keyword">by</span> <span class="keyword">level</span> &lt;= :base</span><br><span class="line">  ),</span><br><span class="line">  <span class="comment">-- Returns rows for all the Quotient and Remainder in dec value</span></span><br><span class="line">  my_data <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">      lvl,</span><br><span class="line">      quotient,</span><br><span class="line">      <span class="keyword">remainder</span></span><br><span class="line">    <span class="keyword">from</span> lvls</span><br><span class="line">    <span class="keyword">model</span></span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">all</span> <span class="keyword">rows</span></span><br><span class="line">      <span class="keyword">dimension</span> <span class="keyword">by</span> (lvl)</span><br><span class="line">      <span class="keyword">measures</span>( <span class="number">0</span> <span class="keyword">remainder</span>, <span class="number">0</span> quotient)</span><br><span class="line">      <span class="keyword">rules</span> (</span><br><span class="line">        <span class="comment">-- Order matters here. I.e. R must come after Q so R can "see" Q</span></span><br><span class="line">        <span class="comment">-- cv docs: https://docs.oracle.com/database/122/SQLRF/Model-Functions.htm#SQLRF51210</span></span><br><span class="line">        quotient[lvl] = trunc(nvl(quotient[cv(lvl)<span class="number">-1</span>], :x) / :base),</span><br><span class="line">        <span class="keyword">remainder</span>[lvl] = <span class="keyword">mod</span>(nvl(quotient[cv(lvl)<span class="number">-1</span>], :x), :base)</span><br><span class="line">      )</span><br><span class="line">  )</span><br><span class="line"><span class="comment">-- For demo purposes</span></span><br><span class="line"><span class="keyword">select</span> md.*, a.letter</span><br><span class="line"><span class="keyword">from</span> my_data md, alphabet a</span><br><span class="line"><span class="keyword">where</span> <span class="number">1</span>=<span class="number">1</span></span><br><span class="line">  <span class="keyword">and</span> md.remainder = a.num</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> md.lvl</span><br><span class="line"><span class="comment">-- Uncomment below for dec2hex conversion</span></span><br><span class="line"><span class="comment">--select</span></span><br><span class="line"><span class="comment">--  listagg(a.letter, '') within group (order by md.lvl desc) basex</span></span><br><span class="line"><span class="comment">--from my_data md, alphabet a</span></span><br><span class="line"><span class="comment">--where 1=1</span></span><br><span class="line"><span class="comment">--  and md.remainder = a.num</span></span><br><span class="line">;</span><br><span class="line"></span><br><span class="line">LVL   QUOTIENT   REMAINDER LETTER</span><br><span class="line">  1         18          12 C</span><br><span class="line">  2          1           2 2</span><br><span class="line">  3          0           1 1</span><br></pre></td></tr></table></figure>
<h2 id="Final-Thoughts"><a href="#Final-Thoughts" class="headerlink" title="Final Thoughts"></a>Final Thoughts</h2><p>The model clause is extremely powerful when used to solve problems it was intended for. The toughest thing to do is learn and understand how it works with all it’s options/function. If it’s any help, I’m still learning more about the model clause and by no means an expert.</p>
<p>If you do some interesting things with a model clause please blog about it and send me a message as I can list future posts in this article.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.talkapex.com/2017/11/how-to-convert-dec-to-any-base-in-sql/" data-id="cjso50c0b00eyedraihnybkna" class="article-share-link">Share</a>
      
        <a href="http://www.talkapex.com/2017/11/how-to-convert-dec-to-any-base-in-sql/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sql/">sql</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/28/">28</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap">
  <h3 class="widget-title">Martin Giffy D'Souza</h3>
  <div class="widget aced">
    <img src="/images/profile-martin.jpg" alt>&nbsp;&nbsp;<a href="http://goo.gl/IOHra"><img src="/images/aced-logo.gif" alt></a>
  </div>
</div>

  
    <div class="widget-wrap">
  <h3 class="widget-title">Links</h3>
  <div class="widget">
    <ul>
      <li><a id="sidebar-link-oos" href="https://github.com/oraopensource/" target="_blank">OraOpenSource</a></li>
      <li><a id="sidebar-link-podcast" href="http://apex.press/talkshow" target="_blank">Oracle APEX Podcast</a></li>
      <li><a id="sidebar-link-rss" href="/atom.xml">RSS Feed</a></li>
      <li><a id="sidebar-link-email" href="mailto:martin@talkapex.com">Email me</a></li>
      <li><a id="sidebar-link-twitter" href="https://twitter.com/martindsouza" target="_blank">Twitter</a></li>
      <li><a id="sidebar-link-linkedin" href="http://www.linkedin.com/in/martingiffydsouza" target="_blank">LinkedIn</a></li>
    </ul>
  </div>
</div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/apex/">apex</a><span class="tag-list-count">146</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/apex-5/">apex-5</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/apex-5-1/">apex-5.1</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/apex-plugin/">apex-plugin</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/best-practice/">best-practice</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/checkbox/">checkbox</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chrome/">chrome</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/design/">design</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dynamic-actions/">dynamic-actions</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iot/">iot</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery/">jquery</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kscope/">kscope</a><span class="tag-list-count">21</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/logger/">logger</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/macos/">macos</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/meta/">meta</a><span class="tag-list-count">19</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/odtug/">odtug</a><span class="tag-list-count">25</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oos-utils/">oos-utils</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oow/">oow</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/open-source/">open-source</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oracle/">oracle</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oracle-12c/">oracle-12c</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oracle-18c/">oracle-18c</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ords/">ords</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/plsql/">plsql</a><span class="tag-list-count">23</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/security/">security</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/">sql</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql-data-modeler/">sql-data-modeler</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql-developer/">sql-developer</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlcl/">sqlcl</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tabular-form/">tabular-form</a><span class="tag-list-count">3</span></li></ul>
    </div>
  </div>


  
    <div class="widget-wrap">
  <h3 class="widget-title">Books</h3>
  <div class="widget">
    <table class="books">
      <tbody>
        <tr>
          <td><img src="/images/book-apex-plugins.jpeg" alt></td>
          <td><img src="/images/book-expert-apex-5.jpeg" alt></td>
        </tr>
        <tr>
          <td><a href="http://goo.gl/089zi">APEX Plugins</a></td>
          <td><a href="http://bit.ly/talkapex-book-expert-2nd-ed">Expert APEX 5</a></td>
        </tr>
        <tr>
          <td><img src="/images/book-begin-apex-4.jpeg" alt></td>
          <td><img src="/images/book-expert-apex-4.jpeg" alt></td>
        </tr>
        <tr>
          <td><a href="http://goo.gl/NxHoF">Beginning APEX 4</a></td>
          <td><a href="http://goo.gl/tXm3P">Expert APEX 4</a></td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/">2018</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/">2017</a><span class="archive-list-count">22</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/">2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/">2015</a><span class="archive-list-count">35</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/">2014</a><span class="archive-list-count">17</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/">2013</a><span class="archive-list-count">35</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/">2012</a><span class="archive-list-count">25</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/">2011</a><span class="archive-list-count">27</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/">2010</a><span class="archive-list-count">40</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/">2009</a><span class="archive-list-count">51</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/">2008</a><span class="archive-list-count">5</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 Martin Giffy D&#39;Souza<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'talkapex';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-8016477-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->




  </div>
</body>
</html>